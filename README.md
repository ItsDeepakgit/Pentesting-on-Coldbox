# Pentesting-on-Coldbox
To assess the security of a ColdBox application and identify potential vulnerabilities that could be exploited by attackers.
## Penetration testing:
Penetration testing, or "pentesting" for short, is the process of identifying and exploiting vulnerabilities in a computer system or network in order to improve its security. There are five penetration testing phases: reconnaissance, scanning, vulnerability assessment, exploitation, and reporting.
## ColdBox:
ColdBox is a popular open-source web application framework that is built on top of the ColdFusion programming language. The framework is designed to be modular and extensible, with a focus on simplicity and ease of use. ColdBox provides a number of features and functionalities that make it popular among developers, including built-in security features such as input validation and output encoding. 

### ColdBox Download Link: https://www.vulnhub.com/entry/colddbox-easy,586/
## Vulnerability Details.
### Vulnerability found:
- CWE - 94: RCE using Reverse shell
### Level Type:
- High
### Description:
The identified vulnerability allows an attacker to upload and execute a reverse shell, enabling them to execute arbitrary commands on the target system remotely.


## Penetration Testing Methodology
- Target Machine IP Address
- Network Scanning
- Enumeration and Identifying Vulnerabilities in WordPress
- Brute Forcing on WordPress Login
- Uploading a Reverse Shell
- Getting Root Privileges and Reading the Flag
### The target machine IP address by running the VM:
1) The first Step to identify the target machine IP address; since I was running the virtual machine in the same network, I can identify the target machine IP address by running the netdiscover command.
Command used:
`netdiscover –r 192.168.56.0/24`

![1 (2)](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/ec6a9bc5-2a2e-4b02-b54c-4958b2890933)

In the above screenshot showing multiple IP address (i.e.: target IP: 192.168.56.102 & Attacker or Kali Machine IP: 192.168.56.100).

### Network Scanning:
2) After getting the target machine IP address, the next step is to find out the open ports and services available on the machine.
Command used:
`nmap -Pn 192.168.56.0/24`

![2](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/2d60a858-9416-4335-9825-cbbcb6b345f9)

For more information I was using whatweb command:

![4](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/73d2cc67-faa9-425d-b6d1-02a7f2ea90bb)

--> Service: http | Version: Apache 2.4.18 | HttpServer: Ubuntu Linux

### Enumeration and Identifying Vulnerabilities in WordPress:
3) From this point I identifies port 80 is opened then it works with the browser. And I enter the target IP into the Mozilla browser.

![3](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/efd92a42-acc4-4da2-aaed-a82282a6e85c)

The bottom of this has a login link. Now I click that and broswer to that link. Then I identify a standard WordPress page.

4) So now, I used Wpscan tool to find out the usernames and passwords. 
Command Used: `wpscan --url http://192.168.56.102 --enumerate u` 

![5](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/dae2c2a6-4f80-41d6-a766-7072f6385e55)

From this, I found there are serveral user names.

![6](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/6909ab87-4b35-4f07-bf51-55cfe0fff4a0)

### Brute Forcing on WordPress Login:
5) Here, I choose the c0ldd username and I perform a brute force attack using wpscan to find the password.
Command Used: `wpscan --url http://192.168.56.102 --usernames c0ldd --passwords /usr/share/wordlists/rockyou.txt`
 
![7](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/2404b8b2-03ff-436c-8df6-47eecc4a662f)

From this, I found that password: 9876543210

6) Now, I used this username and password to log into the WordPress admin dashborad.

![8](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/83e0b122-6ea7-48ce-ad5d-f0b8c41d7f6d)

Now I’m in the admin dashboard. WordPress just like any other content management system always has a way to execute code so long as I was authenticated. In my case edit a 404.php template and use it to get a shell on the box. 

![9](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/b2e60efe-9541-4127-8ae0-6de1b6e24a34)

### Uploading a Reverse Shell:
7) Navigating to appearance -> editor
8) I can add a reverse shell by modifying the 404.php.

![10](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/77cf0575-a4ba-4993-b22d-7ab516a5807c)

9)  In this reverse-shell, I have to change my IP and port.

![11](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/cd2d752a-78d4-48c3-83a5-5b50ac89c4a7)

10) Next, I set up a netcat listener on the box. Re-browsing targeted IP address on the browser. Now, I opened the python spawned shell.

![12](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/a3a6e172-495c-4230-8c0b-98e2dbf8b452)

In the above screenshot, showing the important **wp-config.php** file because it contains the user name and password for the database.

11) Then I used more command to see the file username and password.

![13](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/49e3c11e-166f-4042-a212-3647167189eb)

From this, I can obtain the credentials.

12) Now I used credentials to log into that account.

![14](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/2c2d2c78-5ed0-492b-8c46-9bb02ea77a0a)

13) Next I perform the ls command to know what the files in there are. Then I find a file called user.txt. Now I use cat command to see the content of the file. Then decode this text.

![16](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/f4772586-34c6-48e9-bff5-f46c14bdec8c)

I found the first flag from that file: **Congratulations, first level achieved!** 

![17](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/2cd71271-fc51-425b-91e6-877fe6d4433f)

### Getting Root Privileges and Reading the Flag:

14) I perform sudo –l command to list binary files of root.

![15](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/cf59ad18-6d02-46c4-822d-ec4b7ac9439f)

Next, I used vim to get a root shell. In this below screenshot root flag was found in the root directory as named as ‘root.txt’. It has base64 encoded text. Then I used my kali box to decode this text.

![18](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/1f393a5b-8540-4039-804b-46387e6c6bda)

Finally, I found the root flag from that file: **Congratulations, machine completed!#**

![19](https://github.com/ItsDeepakgit/Pentesting-on-Coldbox/assets/91217911/0f640728-b319-49a7-bba7-55848116f1a1)

## Finding:

The vulnerabilities discovered during the "Pentesting on ColdBox" project was analyzed to determine their potential impact on the application and to recommend appropriate mitigation strategies.
## Impact:

- **Unauthorized Access:** The attacker gains unauthorized access to the system.
- **Data Breach:** The attacker can potentially exfiltrate sensitive data from the compromised system.
- **System Compromise:** Full compromise of the target system, leading to potential disruption or unauthorized modification of system resources.
## Recommendations:

- **File Upload Validation:** Implement proper file upload validation to ensure that only authorized and safe file types are accepted.
- **Input Sanitization:** Sanitize all user inputs to prevent the injection of malicious code.
- **Network Segmentation:** Implement network segmentation to restrict the lateral movement of attackers within the network.
- **Regular Security Audits:** Conduct regular security audits and penetration testing to identify and address potential vulnerabilities proactively.
- **Security Headers:** Utilize security headers like Content Security Policy (CSP) to control which resources can be loaded on your web pages and to mitigate the risk of code injection attacks.
- **Web Application Firewalls (WAF):** Implement a WAF to filter and monitor HTTP traffic between a web application and the Internet. This can help protect against various web-based attacks.
## Conclusion:

The "Pentesting on ColdBox" provided valuable insights into the security posture of a ColdBox application and highlighted the importance of ongoing security testing and risk management. The project identified several vulnerabilities that could be exploited by attackers and provided actionable recommendations for remediation. By addressing these vulnerabilities, the organization can reduce the risk of a successful cyber attack on their ColdBox application, protecting both the organization and its users.




